import{c as k}from"./chunk-445VCDO2.js";import"./chunk-MAVNWS4Y.js";import{h as G,n as N,o as U,p as q}from"./chunk-TCIC4IL3.js";import{$b as b,Db as O,Eb as z,Fb as P,Hb as a,Hc as L,Ib as F,Ic as j,Ja as B,Jb as m,Lc as Q,Na as s,Nc as R,Oc as A,Pb as H,Q as T,R as M,Zb as C,_b as D,ca as u,eb as h,f as w,gb as p,ha as $,p as I,qb as n,ra as _,rb as r,sa as g,sb as S,tb as x,ub as v,v as E,wb as V,yb as f,zb as d}from"./chunk-LUS64HRK.js";import"./chunk-MON7YFGF.js";function J(o,c){o&1&&(x(0),n(1,"div",1),a(2,"Loading..."),r(),v())}function K(o,c){if(o&1&&(n(0,"div",3),a(1),r()),o&2){let e=c.$implicit;s(),m(" ",e," ")}}function W(o,c){if(o&1&&(x(0),h(1,K,2,1,"div",2),v()),o&2){let e=c.ngIf;s(),p("ngForOf",e)}}function X(o,c){if(o&1){let e=V();x(0),n(1,"section",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8),S(6,"img",9),n(7,"h2"),a(8),r()(),n(9,"div",10)(10,"p",11),a(11),r()(),n(12,"div",12)(13,"p")(14,"strong"),a(15,"Rank:"),r(),n(16,"span",13),a(17),r()(),n(18,"p")(19,"strong"),a(20,"Current Price: "),r(),n(21,"span",13),a(22),C(23,"currency"),r()(),n(24,"p")(25,"strong"),a(26,"Market Cap: "),r(),n(27,"span",13),a(28),C(29,"currency"),r()()()(),n(30,"div",14),S(31,"canvas",15),n(32,"div",16)(33,"button",17),f("click",function(){_(e);let t=d();return g(t.initializeData(1))}),a(34," 24 hours "),r(),n(35,"button",17),f("click",function(){_(e);let t=d();return g(t.initializeData(30))}),a(36," 30 days "),r(),n(37,"button",17),f("click",function(){_(e);let t=d();return g(t.initializeData(90))}),a(38," 90 days "),r(),n(39,"button",17),f("click",function(){_(e);let t=d();return g(t.initializeData(365))}),a(40," 1 year "),r()()()()()(),v()}if(o&2){let e=d();s(6),p("src",e.coin==null||e.coin.image==null?null:e.coin.image.large,B),s(2),m(" ",e.coin.name," "),s(3),m(" ",e.coin==null||e.coin.description==null?null:e.coin.description.en.split(". ")[0]," "),s(6),F(e.coin==null?null:e.coin.market_cap_rank),s(5),m(" ",b(23,9,e.coin==null?null:e.coin.market_data.current_price.inr,e.currency)," "),s(6),m(" ",b(29,12,e.coin==null?null:e.coin.market_data.market_cap.inr,e.currency)," "),s(3),p("data",e.lineChartData)("options",e.lineChartOptions)("type",e.lineChartType)}}var pe=(()=>{let c=class c{constructor(){this.loadingS=u(U),this.route=u(G),this.days=30,this.currencyService=u(N),this.currency="INR",this.endSub$=new w,this.messages=u(q),this.lineChartType="line",this.lineChartData={datasets:[{data:[],label:"Price Trends",backgroundColor:"rgba(148,159,177,0.2)",borderColor:"#185ff6",pointBackgroundColor:"#185ff6",pointBorderColor:"#185ff6",pointHoverBackgroundColor:"#185ff6",pointHoverBorderColor:"#185ff6"}],labels:[]},this.lineChartOptions={elements:{point:{radius:1}},plugins:{legend:{display:!0}}}}ngOnInit(){this.route.params.subscribe(i=>{this.coinId=i.id,this.initializeData()})}initializeData(i){i!==void 0&&(this.days=i),this.currencyService.currency$.pipe(M(this.endSub$),T(t=>(this.currency=t,E({coinData:this.getCoinData(),graphData:this.getGraphData(this.days)})))).subscribe({next:({coinData:t,graphData:l})=>{this.coin=t,this.updateChartData(l)}})}getCoinData(){return this.currencyService.getCurrencyById(this.coinId).pipe(I(i=>(this.currency==="USD"&&(i.market_data.current_price.inr=i.market_data.current_price.usd,i.market_data.market_cap.inr=i.market_data.market_cap.usd),i)))}getGraphData(i){return this.days=i,this.currencyService.getGraphicalCurrencyData(this.coinId,this.currency,this.days)}updateChartData(i){this.lineChartData.datasets[0].data=i.prices.map(t=>t[1]),this.lineChartData.labels=i.prices.map(t=>{let l=new Date(t[0]),y=l.getHours()>12?`${l.getHours()-12}: ${l.getMinutes()} PM`:`${l.getHours()}: ${l.getMinutes()} AM`;return this.days===1?y:l.toLocaleDateString()}),setTimeout(()=>{this.myLineChart.chart?.update()},200)}ngOnDestroy(){this.endSub$.next(()=>{}),this.endSub$.complete()}};c.\u0275fac=function(t){return new(t||c)},c.\u0275cmp=$({type:c,selectors:[["app-coin-details"]],viewQuery:function(t,l){if(t&1&&O(k,5),t&2){let y;z(y=P())&&(l.myLineChart=y.first)}},standalone:!0,features:[H],decls:5,vars:7,consts:[[4,"ngIf"],[1,"loading-spinner"],["class","alert alert-danger",4,"ngFor","ngForOf"],[1,"alert","alert-danger"],[1,"details","my-3"],[1,"container-fluid"],[1,"row"],[1,"col-12","col-lg-4","border-right-1"],[1,"img-wrapper","d-flex","align-items-center","justify-content-center","flex-column",2,"width","100%"],["alt","",1,"img-fluid","rounded-circle","mb-2",2,"width","150px","height","150px",3,"src"],[1,"text","ms-3"],[1,"desc"],[1,"meta-data","ps-3","mt-5"],[1,"ms-3"],[1,"col-12","col-lg-8"],["baseChart","",2,"width","300px",3,"data","options","type"],[1,"d-flex","justify-content-around"],[1,"btn","btn-custom",3,"click"]],template:function(t,l){t&1&&(h(0,J,3,0,"ng-container",0),C(1,"async"),h(2,W,2,1,"ng-container",0),C(3,"async"),h(4,X,41,15,"ng-container",0)),t&2&&(p("ngIf",D(1,3,l.loadingS.loading$)),s(2),p("ngIf",D(3,5,l.messages.errors$)),s(2),p("ngIf",l.coin))},dependencies:[A,L,j,Q,R,k],styles:[".text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block}"]});let o=c;return o})();export{pe as CoinDetailsComponent};
